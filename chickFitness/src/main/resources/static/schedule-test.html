<!doctype html>
<html lang="en">

<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
	crossorigin="anonymous">

<title>Planner</title>
<link rel="stylesheet" type="text/css" href="css/courses.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>

	<nav class="navbar navbar-expand-lg navbar-light bg-warning">
		<div class="container-fluid">
			<img src="img/egg-nav.png" height="30"
				class="d-inline-block align-top ">
			<span class="navbar-brand mb-0 h1">GUGU Fitness</span>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item active"><a class="nav-link" href="/index.html">Home</a></li>
					<li class="nav-item"><a class="nav-link" href="/courses.html">Courses</a></li>
					<li class="nav-item"><a class="nav-link" href="/schedule-test.html">My Plan</a></li>
					<li class="nav-item"><a class="nav-link" href="/feed.html">My Chick</a></li>
				</ul>
				<form class="d-flex">
					<p id="memberId" style="display: none;"></p>
					<a class="btn btn-outline-dark" href="member.html">會員專區???要連結到?</a>
				</form>
			</div>
		</div>
	</nav>


	<div class="container">
		<!--主container-->

		<div class="jumbotron">
		<p id="memberId" style="display:none;"></p>
			<h1 class="display-4">Planner</h1>
			<p class="lead">
				歡迎回到您的個人運動計劃頁面！這裡不僅是您的健身指南，更是與您的小雞夥伴一同成長的場所。<br>您的每一次努力都是成就更健康、更強壯的自己的一步。開始吧，您的小雞夥伴正期待著與您一同進步！
			</p>
			<hr class="my-4">
			<div class="text-center">
				<p>
					您可以輕鬆查看自己排定的運動計劃，了解目標和挑戰。隨時調整您的計劃，確保它們與您的需求相符。<br>這個頁面是您的運動日誌，記錄著每次運動的時數，並以此來幫助小雞獲得寶貴的經驗值。
				</p>

			</div>

			<hr class="my-4">
		</div>

		<div class="container " style="height: 1400px;">
			<div class="row" id="mon">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Monday</span>
					</h2>
				</div>
				<div class="col-10" id="monDiv">
				<div class="row card-container"></div>
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="tue">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Tuesday</span>
					</h2>
				</div>
				<div class="col-10" id="tueDiv">
				<div class="row card-container"></div>
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="wed">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Wednesday</span>
					</h2>
				</div>
				<div class="col-10" id="wedDiv">
				
				<div class="row card-container"></div>
				
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="thu">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Thursday</span>
					</h2>
				</div>
				<div class="col-10" id="thuDiv">
				<div class="row card-container"></div>
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="fri">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Friday</span>
					</h2>
				</div>
				<div class="col-10" id="friDiv">
				<div class="row card-container"></div>
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="sat">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Saturday</span>
					</h2>
				</div>
				<div class="col-10" id="satDiv">
				<div class="row card-container"></div>
				</div>
			</div>

			<hr style="width: 100%;">
			<div class="row" id="sun">
				<div class="col-2">
					<h2>
						<span class="badge bg-warning text-dark">Sunday</span>
					</h2>
				</div>
				<div class="col-10" id="sunDiv">
				<div class="row card-container"></div>
				</div>
			</div>
		</div>
		<div class="card forClone" style="width: 270px; margin: 10px; display:none;">
			
			<div class="card-body">
				<h5 class="card-title course_name">Card title</h5>
				<p class="courese_id" style="display: none;"></p>
				<p class="curl" style="display: none;"></p>
				<div class="text-end">
					<button type="button" class="btn btn-warning goStart"  data-course-name="" data-youtube-url=""
						data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="goS(this)">
						Start!</button>
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static"
			data-bs-keyboard="false" tabindex="-1"
			aria-labelledby="staticBackdropLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-5" id="staticBackdropLabel">Modal
							title</h1>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<div class="ratio ratio-16x9">
							<iframe src="" title="YouTube video" allowfullscreen></iframe>
						</div>
						<div class="text-center" id="clock">
							<div id="timer">
								<p class="fs-1" id="time-text">00:00:00</p>
							</div>
							<div class="btn-group" role="group"
								aria-label="Basic radio toggle button group">
								<input type="radio" class="btn-check" name="btnradio" id="start"
									autocomplete="off" checked> <label
									class="btn btn-outline-warning" for="start">開始</label> <input
									type="radio" class="btn-check" name="btnradio" id="pause"
									autocomplete="off"> <label
									class="btn btn-outline-warning" for="pause">暫停</label> <input
									type="radio" class="btn-check" name="btnradio" id="stop"
									autocomplete="off"> <label
									class="btn btn-outline-warning" for="stop">結束</label>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-warning" onclick="done(document.getElementById('time-text'))">完成運動</button>
					</div>
				</div>
			</div>
			<script>
        $(document).ready(function () {
            var timer;
            var isRunning = false;
            var hours = 0;
            var minutes = 0;
            var seconds = 0;
            


            function updateTimerText() {
                $("#time-text").text(
                    (hours < 10 ? "0" : "") + hours + ":" +
                    (minutes < 10 ? "0" : "") + minutes + ":" +
                    (seconds < 10 ? "0" : "") + seconds
                );
            }

            function startTimer() {
                isRunning = true;
                timer = setInterval(function () {
                    seconds++;
                    if (seconds === 60) {
                        seconds = 0;
                        minutes++;
                        if (minutes === 60) {
                            minutes = 0;
                            hours++;
                        }
                    }
                    updateTimerText();
                }, 1000);
            }



            function pauseTimer() {
                isRunning = false;
                clearInterval(timer);
            }

            function stopTimer() {
                isRunning = false;
                clearInterval(timer);
                // 不重置时间，只是更新文本显示
                updateTimerText();
                $("#start").prop("disabled", true);
                $("#pause").prop("disabled", true);
            }

            $("#start").click(function () {
                if (!isRunning) {
                    startTimer();
                }
            });

            $("#pause").click(function () {
                if (isRunning) {
                    pauseTimer();
                }
            });

            $("#stop").click(function () {
                stopTimer();
            });

        });
        
        function done(timeTextElement){
        	var timeText = timeTextElement.innerText;
        	var sid=$("#memberId").text();
        	var obj={};
        	obj.sid=$("#memberId").text();
        	console.log("donetime:"+timeText);
        	console.log("memberId:"+sid);
        }
    </script>
		</div>
	</div>
	<footer class="footer"
		style="padding: 50px 50px; background-color: gray;">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-lg-6 text-center">
					<p class="text-light">&copy; 2023 GuGuchick Fitness。保留所有權利。</p>
					<p class="text-light">
						免責聲明：<br>本網站提供的信息僅供一般信息目的。<br>在開始任何運動或飲食計劃前，請諮詢醫療專業人員。
					</p>
				</div>
			</div>
			<div class="row justify-content-center">
				<div class="col-lg-6 text-center">
					<ul class="list-inline social-media">
						<li class="list-inline-item"><a href="#"><i
								class="fab fa-facebook"></i></a></li>
						<li class="list-inline-item"><a href="#"><i
								class="fab fa-twitter"></i></a></li>
						<li class="list-inline-item"><a href="#"><i
								class="fab fa-instagram"></i></a></li>
					</ul>
					<p class="text-light">聯繫我們：Guguchick@gmail.com</p>
				</div>
			</div>
			<div class="row justify-content-center">
				<div class="col-lg-6 text-center">
					<div class="scroll-to-top">
						<!-- 將按鈕樣式改為簡約風格 -->
						<a href="#" class="btn btn-outline-warning slogan-button "> <i
							class="fas fa-arrow-up"></i> 返回頂部
						</a>
					</div>
					<br>
					<p class="text-light">
						<a href="privacy.html" class="text-warning">隱私政策</a> | <a
							href="terms.html" class="text-warning">使用條款</a>
					</p>
				</div>
			</div>
		</div>
	</footer>
</body>
<script>
	$(document).ready(getAll);
	
	

	function getAll() {
		$.get('http://localhost:8080/session', function(dataM) {
			$("#memberId").html(dataM.memberId);
			var mId = dataM.memberId;
			$.get('http://localhost:8080/schedule3/get/plan/' + mId, function(
					dataW) {
				// 创建一个对象来跟踪每个星期的cid
				var weekCids = {
					mon : [],
					tue : [],
					wed : [],
					thu : [],
					fri : [],
					sat : [],
					sun : []
				};

				// 遍历 dataW 数组
				dataW.forEach(function(item) {
					// 将 cid 添加到对应星期的数组中
					if (item.mon)
						weekCids.mon.push(item.cid);
					if (item.tue)
						weekCids.tue.push(item.cid);
					if (item.wed)
						weekCids.wed.push(item.cid);
					if (item.thu)
						weekCids.thu.push(item.cid);
					if (item.fri)
						weekCids.fri.push(item.cid);
					if (item.sat)
						weekCids.sat.push(item.cid);
					if (item.sun)
						weekCids.sun.push(item.cid);
				});

				// 将跟踪的cid显示在相应的星期div下
				for ( var day in weekCids) {
					var dayDivId = getDayDivId(day);
					var dayDiv = $("#" + dayDivId);

	                weekCids[day].forEach(function (cid) {
	                    var cardClone = $(".forClone").clone().removeClass("forClone");
	                    var matchingCourse = dataW.find(function (item) {
	                        return item.cid === cid;
	                    });

	                    if (matchingCourse) {
	                        cardClone.find(".course_name").html(matchingCourse.courseName);
	                        cardClone.find(".curl").html(matchingCourse.url);
	                        cardClone.find(".courese_id").html(matchingCourse.cid);
	                        cardClone.find(".goStart").attr("data-course-name", matchingCourse.courseName);
	                        cardClone.find(".goStart").attr("data-youtube-url", matchingCourse.url);
	                        cardClone.css("display", "");
	                       
	                        var cardContainer = dayDiv.find(".card-container");
	                        cardClone.appendTo(cardContainer);
	                        
	                        
	                    }
	                });
	            }
	        });
	    });
	}					
					


	function getDayDivId(day) {
		// 根据星期的值返回对应的 div id
		switch (day) {
		case "mon":
			return "monDiv";
		case "tue":
			return "tueDiv";
		case "wed":
			return "wedDiv";
		case "thu":
			return "thuDiv";
		case "fri":
			return "friDiv";
		case "sat":
			return "satDiv";
		case "sun":
			return "sunDiv";
		default:
			return "";
		}
	}
	
	function goS(button) {

	    var courseName = $(button).data("course-name");
	    var youtubeUrl = $(button).data("youtube-url");
	    
	    console.log("courseName:", courseName);
	    console.log("youtubeUrl:", youtubeUrl);
	    
	    // 设置 modal 标题和 iframe 的 src
	    $("#staticBackdropLabel").text(courseName);
	    $("#staticBackdrop iframe").attr("src", 'https://www.youtube.com/embed/' + youtubeUrl);
	    
	    // 打开 modal
	    $('#staticBackdrop').modal('show');
	}
	

</script>

<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
	crossorigin="anonymous"></script>

</html>
